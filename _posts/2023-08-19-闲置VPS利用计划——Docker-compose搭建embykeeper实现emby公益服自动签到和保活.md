---
title: é—²ç½®VPSåˆ©ç”¨è®¡åˆ’â€”â€”Docker composeæ­å»ºembykeeperå®ç°embyå…¬ç›Šæœè‡ªåŠ¨ç­¾åˆ°å’Œä¿æ´»
date: 2023-08-19T18:57:42+08:00
lastmod: 2023-08-20T18:57:42+08:00
tags: 
    - ğŸ˜Linux
    - ğŸ‹Docker
    - ğŸ’»é—²ç½®VPSåˆ©ç”¨è®¡åˆ’
    - ğŸ“ºEMBY
author: yuniee
summary: embyå…¬ç›Šæœæ— éœ€æ¯å¤©æ‰‹åŠ¨ç­¾åˆ°è·å–ç§¯åˆ†ï¼Œä¹Ÿä¸éœ€è¦ç»å¸¸çœ‹è§†é¢‘ä¿æ´»äº†ã€‚
image: https://s2.loli.net/2023/08/24/VpMi5Nvn98ysKhP.png
---

# é—²ç½®VPSåˆ©ç”¨è®¡åˆ’â€”â€”Docker composeæ­å»ºembykeeperå®ç°embyå…¬ç›Šæœè‡ªåŠ¨ç­¾åˆ°å’Œä¿æ´»

## ğŸ§œâ€â™‚ï¸å‰è¨€

æ¯å¤©åœ¨ç¾¤é‡Œè¹²ç€æŠ¢æ³¨äº†é‚£ä¹ˆå¤šembyå…¬ç›Šæœï¼Œå› ä¸ºæ˜¯å…¬ç›Šæœï¼Œæ‰€ä»¥éƒ½æ˜¯å…¬ç›Šæœæœä¸»å…è´¹åˆ†äº«ç»™å¤§å®¶çš„æœåŠ¡ï¼ˆæ„Ÿè°¢å…¬ç›Šæœä¸»ä»¬çš„æ— ç§åˆ†äº«ğŸ«¡ï¼‰ã€‚æ‰€ä»¥æˆ‘ä¹Ÿå¸Œæœ›å¤§å®¶éƒ½ä¸è¦æ³¨å†Œè´¦å·åä¸ä½¿ç”¨ï¼Œè¿™ä¼šå ç”¨çœŸçš„æƒ³è¦çœ‹å…¬ç›Šæœçš„äººçš„æ³¨å†Œèµ„æ ¼ã€‚å› ä¸ºç­¾åˆ°ä¿å·é¡¹ç›®æœ¬å°±æ˜¯å…¬ç›Šæœä¸»ä»¬ç”¨æ¥ç­›é€‰çœŸæ­£éœ€è¦è´¦å·çš„ç”¨æˆ·ä½¿ç”¨çš„ã€‚ä½†æœ‰æ—¶ä½ çœŸçš„éœ€è¦çœ‹embyï¼Œä½†æ˜¯è¿™æ®µæ—¶é—´å¾ˆå¿™ï¼Œæˆ–è€…ä½ å®³æ€•æ€»æ˜¯å¿˜è®°ç­¾åˆ°ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‰ç”¨åˆ°æœ¬é¡¹ç›®ã€‚å¸Œæœ›å¤§å®¶æŒ‰éœ€ä½¿ç”¨ã€‚

### 



é¡¹ç›®çš„GitHubåœ°å€ï¼š[GitHub](https://github.com/embykeeper/embykeeper)

æ„Ÿè°¢å¼€å‘å›¢é˜Ÿå¼€å‘å‡ºè¿™ä¹ˆå®ç”¨çš„é¡¹ç›®ğŸ‘

## ğŸ¹å¼€å§‹æ­å»º

### ğŸ¤–å‡†å¤‡å·¥ä½œ

æ›´æ–°ç³»ç»Ÿï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯Debian11ç³»ç»Ÿï¼ˆUbuntuåŒç†ï¼‰

```bash
apt update -y && apt upgrade -y
```

å®‰è£…å¿…è¦å·¥å…·

```bash
apt install wget curl sudo vim git  -y
```

### ğŸ‹å®‰è£…dockerï¼Œdocker-composeå¹¶é…ç½®

1. ä¸‹è½½docker   

```bash
wget -qO- get.docker.com | bash
```

2. è®¾ç½®dockerå¼€æœºè‡ªå¯

```bash
systemctl enable docker
```

3. é‡å¯docker

```bash
systemctl restart docker
```

4. å®‰è£…docker-compose

```bash
sudo curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
```

5. docker-composeèµ‹æƒ

```bash
sudo chmod +x /usr/local/bin/docker-compose
```

6. ä¿®æ”¹æ—¶åŒºä¸ºä¸Šæµ·

```bash
sudo timedatectl set-timezone Asia/Shanghai
```

### ğŸ§¢é¡¹ç›®éƒ¨ç½²

æˆ‘æƒ³è¦å°†æœ¬é¡¹ç›®å®‰è£…å¹¶æ˜ å°„åœ¨`/opt/embykeeper`ç›®å½•ä¸‹,æ‰€ä»¥é¦–å…ˆåˆ›å»ºç›®å½•å¹¶åˆ‡æ¢åˆ°æˆ‘åˆ›å»ºçš„ç›®å½•ä¸‹ã€‚

```bash
mkdir -p /opt/embtkeeper && cd /opt/embtkeeper
```

æ ¹æ®å®˜æ–¹æ–‡æ¡£é‡Œæè¿°ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨docker-composeä¹‹å‰è¿˜å¿…é¡»ç”¨docker runè¿è¡Œä¸€æ¬¡ã€‚æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬å…ˆè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
docker run -v /opt/embtkeeper:/app --rm -it --net=host embykeeper/embykeeper
```

ç­‰å¾…é•œåƒæ‹‰å–å®Œæ¯•ä¹‹åä½ ä¼šå‘ç°`/opt/embtkeeper`ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ª`config.toml`æ–‡ä»¶ã€‚æ ¹æ®è‡ªå·±å®é™…æƒ…å†µä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ã€‚æ–‡ä»¶ä¸­å†™å¾—å·²ç»è¶³å¤Ÿè¯¦ç»†äº†ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä½ åªéœ€è¦ä¿®æ”¹`service` , `telegram`å’Œ`emby`è¿™ä¸‰ä¸ªéƒ¨åˆ†çš„é…ç½®ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é…ç½®ä»£ç†ã€‚[ğŸ˜¶â€ğŸŒ«ï¸å®˜æ–¹é…ç½®é¡¹è§£é‡Š](#ğŸ¦™å®˜æ–¹æ–‡æ¡£ä¸­çš„é…ç½®é¡¹)

åœ¨ä¿®æ”¹ä¹‹åæˆ‘ä»¬å†æ¬¡è¾“å…¥docker runå‘½ä»¤è¿è¡Œä¸€æ¬¡,æ­¤æ¬¡è¿è¡Œæ˜¯ä¸ºäº†å¼•å¯¼ä½ ç™»å½•telegramè´¦å·ç„¶åç”Ÿæˆç”Ÿæˆ `.session` æ–‡ä»¶ï¼Œè¿™æ ·æ‰èƒ½æ¯æ¬¡ç™»å½•ä½ çš„è´¦å·ã€‚

```bash
docker run -v /opt/embtkeeper:/app --rm -it --net=host embykeeper/embykeeper
```

æ¥ä¸‹æ¥æ ¹æ®å¼•å¯¼ï¼Œè¾“å…¥ç™»é™†éªŒè¯ç ä»¥åŠä½ è´¦å·è®¾ç½®çš„äºŒæ¬¡éªŒè¯å¯†ç ã€‚ä¹‹åå°±å¼€å§‹æ‰§è¡Œä¿æ´»å’Œç­¾åˆ°äº†ã€‚æ‰§è¡Œå®Œæ¯•ä¸€æ¬¡ä¹‹åå°±`ctrl+C`é€€å‡ºã€‚ç„¶ååˆ›å»ºdocker-compose.ymlæ–‡ä»¶ï¼š

```yaml
version: '3'
services:
  embykeeper:
    container_name: embykeeper
    image: embykeeper/embykeeper
    restart: unless-stopped
    volumes:
      - /opt/embtkeeper:/app       #å†’å·å·¦è¾¹ä¿®æ”¹ä¸ºä½ æƒ³æ˜ å°„çš„è·¯å¾„
    network_mode: host 
  watchtower:                      #è¿™ä¸ªç¨‹åºæ˜¯ç”¨æ¥è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬çš„
    container_name: watchtower
    image: containrrr/watchtower
    restart: unless-stopped
    volumes:
      - /opt/embtkeeper/var/run/docker.sock:/var/run/docker.sock:rw #å†’å·å·¦è¾¹ä¿®æ”¹ä¸ºä½ æƒ³è¦æ˜ å°„çš„è·¯å¾„
```

ç„¶åè¾“å…¥

```bash
docker-compose up -d
```

å®ƒå°±ä¼šåœ¨åå°è¿è¡Œäº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¾“å…¥ `docker logs -f embykeeper` æˆ– `docker-compose logs -f embykeeper` ä»¥æŸ¥çœ‹æœ€æ–°æ—¥å¿—ã€‚



## ğŸ¨åè®°

### ğŸ«telegramé€šçŸ¥ 

å¯ä»¥é€šè¿‡è®¾ç½®é¡¹ "`notifier`" è®¾ç½® æˆåŠŸ/å¤±è´¥ é€šçŸ¥å°†è¢«å‘é€çš„ Telegram è´¦å·, æ‚¨å¯ä»¥é€šè¿‡ [Embykeeper Bot](https://t.me/embykeeper_bot) è®¾ç½®æ¶ˆæ¯æ¯æ—¥å‘é€çš„æ—¶é—´ã€‚

### ğŸ¦™å®˜æ–¹æ–‡æ¡£ä¸­çš„é…ç½®é¡¹

| è®¾ç½®é¡¹       | å€¼ç±»å‹             | ç®€ä»‹                                         | é»˜è®¤å€¼  |
| ------------ | ------------------ | -------------------------------------------- | ------- |
| `timeout`    | `int`              | Telegram æœºå™¨äººç­¾åˆ°è¶…æ—¶ (ç§’)                 | `120`   |
| `retries`    | `int`              | Telegram æœºå™¨äººç­¾åˆ°é”™è¯¯é‡è¯•æ¬¡æ•°              | `4`     |
| `concurrent` | `int`              | Telegram æœºå™¨äººç­¾åˆ°æœ€å¤§å¹¶å‘                  | `1`     |
| `random`     | `int`              | Telegram æœºå™¨äººç­¾åˆ°å„ç«™ç‚¹é—´æ—¶é—´éšæœºé‡ (åˆ†é’Ÿ) | `15`    |
| `notifier`   | `int`/`bool`/`str` | å‘é€é€šçŸ¥åˆ° Telegram è´¦å· (åºå·/æ‰‹æœºå·)       | `False` |
| `service`    | `dict`             | ç­¾åˆ°/æ°´ç¾¤/ç›‘è§†åŠŸèƒ½å¼€å¯ç«™ç‚¹è®¾ç½®               | `{}`    |
| `proxy`      | `dict`             | ä»£ç†è®¾ç½®                                     | `{}`    |
| `telegram`   | `list`             | Telegram è´¦å·è®¾ç½® (æ”¯æŒå¤šè´¦å·)               | `[]`    |
| `emby`       | `list`             | Emby è´¦å·è®¾ç½® (æ”¯æŒå¤šè´¦å·)                   | `[]`    |

`service`è®¾ç½®å¯ä»¥ä¸º:

| è®¾ç½®é¡¹      | å€¼ç±»å‹ | ç®€ä»‹           | é»˜è®¤å€¼               |
| ----------- | ------ | -------------- | -------------------- |
| `checkiner` | `list` | å¯ç”¨çš„ç­¾åˆ°ç«™ç‚¹ | (å½“å‰æ‰€æœ‰æ”¯æŒçš„ç«™ç‚¹) |
| `monitor`   | `list` | å¯ç”¨çš„ç›‘è§†ä¼šè¯ | (å½“å‰æ‰€æœ‰æ”¯æŒçš„ä¼šè¯) |
| `messager`  | `list` | å¯ç”¨çš„æ°´ç¾¤ä¼šè¯ | (å½“å‰æ‰€æœ‰æ”¯æŒçš„ä¼šè¯) |

æ³¨æ„, å½“æ‚¨æœªæ›¾ä¸ç«™ç‚¹æœºå™¨äººå¯¹è¯, è¯¥ç«™ç‚¹ç­¾åˆ°å°†ä¸ä¼šè¿è¡Œ. è‹¥æ‚¨éœ€è¦ç¦ç”¨éƒ¨åˆ†ç­¾åˆ°ç«™ç‚¹, æ‚¨å¯ä»¥åœ¨åˆ—è¡¨ä¸­åˆ é™¤å¯¹åº”çš„åç§°. è‹¥æ‚¨éœ€è¦ä½¿ç”¨é»˜è®¤ç¦ç”¨çš„ç­¾åˆ°ç«™ç‚¹, æ‚¨å¯ä»¥åœ¨åˆ—è¡¨ä¸­å¢åŠ å¯¹åº”çš„åç§°. è‹¥æ‚¨è®¾ç½®é”™è¯¯, ç¨‹åºå°†è·³è¿‡å¹¶æç¤ºæ‚¨æ‰€æœ‰å¯é€‰çš„ç«™ç‚¹å. å½“å‰æ”¯æŒçš„åç§°åŒ…æ‹¬:

| ç«™ç‚¹        | åç§°       |      | ç«™ç‚¹        | åç§°          |
| ----------- | ---------- | ---- | ----------- | ------------- |
| åƒåœ¾å½±éŸ³    | `ljyy`     |      | æœä¹¦ç¥å™¨    | `sosdbot`     |
| å·æ¯›é¼  IPTV | `jms_iptv` |      | ç»ˆç‚¹ç«™      | `terminus`    |
| Pornemby    | `pornemby` |      | Singularity | `singularity` |
| Peach       | `peach`    |      | Nebula      | `nebula`      |
| Bluesea     | `bluesea`  |      | Embyhub     | `embyhub`     |
| å·æ¯›é¼       | `jms`      |      | å¡æˆ        | `charon`      |

`proxy` è®¾ç½®å¯ä»¥ä¸º:

| è®¾ç½®é¡¹     | å€¼ç±»å‹ | ç®€ä»‹                                    | é»˜è®¤å€¼      |
| ---------- | ------ | --------------------------------------- | ----------- |
| `hostname` | `str`  | ä»£ç†æœåŠ¡å™¨åœ°å€                          | `localhost` |
| `port`     | `int`  | ä»£ç†ç«¯å£å·                              | `1080`      |
| `scheme`   | `str`  | ä»£ç†åè®®, å¯ä»¥ä¸º "`socks5`" æˆ– "`http`" | `socks5`    |

`telegram` è®¾ç½®å¯ä»¥ä¸º:

| è®¾ç½®é¡¹     | å€¼ç±»å‹ | ç®€ä»‹                                                         | é»˜è®¤å€¼  |
| ---------- | ------ | ------------------------------------------------------------ | ------- |
| `phone`    | `str`  | è´¦æˆ·æ‰‹æœºå·, ä¸€èˆ¬ä¸º "`+86...`"                                |         |
| `monitor`  | `bool` | å¯ç”¨ç¾¤ç»„ç›‘æ§ç³»åˆ—åŠŸèƒ½                                         | `false` |
| `send`     | `bool` | å¯ç”¨è‡ªåŠ¨æ°´ç¾¤ç³»åˆ—åŠŸèƒ½                                         | `false` |
| `api_id`   | `str`  | (å¯é€‰) ä»[Telegram å®˜ç½‘](https://my.telegram.org/)ç”³è¯·çš„ Application ID |         |
| `api_hash` | `str`  | (å¯é€‰) ä»[Telegram å®˜ç½‘](https://my.telegram.org/)ç”³è¯·çš„ Application Hash |         |

å¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ° 'API_ID_PUBLISHED_FLOOD' é”™è¯¯, æ‚¨å¯èƒ½éœ€è¦ç”³è¯·è‡ªå·±çš„ API, å¯ä»¥é€šè¿‡ [Telegram å®˜ç½‘](https://my.telegram.org/) ç”³è¯· `api_id` å’Œ `api_hash`. ç™»é™†åé€‰æ‹© `API development tools`, éšååº”ç”¨ä¿¡æ¯å¯ä»¥éšæ„å¡«å†™, è¯·æ³¨æ„ `URL` æ˜¯å¿…å¡«é¡¹, å¯ä»¥å¡«å†™ `localhost`. æäº¤æ—¶è‹¥æ˜¾ç¤º "Error", æ‚¨å¯èƒ½éœ€è¦å†æ¬¡å¤šæ¬¡ç‚¹å‡»æäº¤, æˆ–ç­‰å¾…æ–°è´¦æˆ·è„±ç¦»é£æ§æœŸ/æ›´æ¢ä»£ç†/æ¸…é™¤æµè§ˆå™¨è®°å½•å¹¶é‡è¯•. ç”³è¯·åè¯·å°† api_id å’Œ api_hash å¡«å…¥ telegram é…ç½®ä¸­å³å¯.

`emby` è®¾ç½®å¯ä»¥ä¸º:

| è®¾ç½®é¡¹     | å€¼ç±»å‹ | ç®€ä»‹                                                      | é»˜è®¤å€¼ |
| ---------- | ------ | --------------------------------------------------------- | ------ |
| `url`      | `str`  | Emby æœåŠ¡å™¨åœ°å€, ä¸€èˆ¬ä¸º "`https://...`" æˆ– "`http://...`" |        |
| `username` | `str`  | Emby æœåŠ¡å™¨ç”¨æˆ·å                                         |        |
| `password` | `str`  | Emby æœåŠ¡å™¨å¯†ç                                            |        |
| `time`     | `int`  | æ¨¡æ‹Ÿè§‚çœ‹çš„æ—¶é—´ (ç§’)                                       | `800`  |
| `progress` | `int`  | è§‚çœ‹åæ¨¡æ‹Ÿè¿›åº¦æ¡ä¿å­˜çš„æ—¶é—´ (ç§’)                           | `1000` |

æœåŠ¡å¯ä»¥è¿›è¡Œç‰¹å®šé…ç½®, å¦‚ä¸‹æ‰€ç¤º:

```
[monitor.bgk] # æ”¯æŒ bgk, embyhub, polo
unique_name = "your_username_for_registeration" # è‡ªåŠ¨æŠ¢æ³¨æ—¶ä½¿ç”¨çš„ç”¨æˆ·å

[monitor.pornemby]
only_history = true # ä»…å½“é—®é¢˜å†å²ä¸­æ‰¾åˆ°ç­”æ¡ˆæ—¶è‡ªåŠ¨å›ç­”
```